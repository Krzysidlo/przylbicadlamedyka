function loadScript(e,t){var a=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=JS_URL+"/"+e,n.onreadystatechange=t,n.onload=t,a.appendChild(n)}var index=function(){function e(e,t,a){t=t||"danger",a=void 0!==a?a:3e3;var n=$("<div>").addClass("kjtoast hidden alert alert-"+t);if(n.html(e),n.appendTo($("body .toastContainer")),n.fadeIn(),a>0){var o=setTimeout(function(){n.fadeOut(function(){n.remove()})},a);n.on("mouseenter",function(){clearTimeout(o)}).on("mouseleave",function(){o=setTimeout(function(){n.fadeOut(function(){n.remove()})},3e3)}).on("click",function(){clearTimeout(o),n.fadeOut(function(){n.remove()})})}return n}function t(){$("#loading").fadeIn()}function a(){$("#loading").fadeOut()}function n(){i.fadeIn(),$("body").addClass("no_scroll"),setTimeout(function(){o()},7e3)}function o(){i.fadeOut();$("body").removeClass("no_scroll")}var i=$("#preloader");$(window).on("load",function(){o()}),$(function(){var i=$("body");$(document).trigger("scroll"),!function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}()&&i.height()>$(window).height()&&i.addClass("desktop"),function(){var e,t=$("body"),a=$("nav.navbar"),n=a.find(".navbar-toggler"),o=a.find(".navbar-collapse"),i=a.find(".notifications");n.on("click",function(){o.hasClass("show")?t.removeClass("collapsed"):t.addClass("collapsed")}),i.find("#notifications").on("click",function(){e=setTimeout(function(){$.ajax({url:"/ajax/notifications.php?ajax=true",data:{action:"read"},type:"POST",dataType:"JSON",success:function(e){e.success&&i.find("#notifications .num").html("0").removeClass("new")}})},1500)}).on("blur",function(){clearTimeout(e)}),i.find(".dropdown-menu a.dropdown-item").on("click",function(e){var a=$(this).attr("href"),o=window.location.pathname,i=a.split("#");shouldPrevent="#"===a,shouldPrevent&&e.preventDefault(),shouldPrevent|=a.indexOf("#")>=0&&i[0]==o,shouldPrevent&&(e.stopPropagation(),t.hasClass("collapsed")&&n.trigger("click"))})}(),$(".dropdown #change + .dropdown-menu .dropdown-item").on("click",function(){$(this).closest("form").submit()}),function(){if($("section.loginRegister").length<=0){var t=$("#surpriseModal"),a=$("#cheatingModal"),n=t.find("img.img-responsive"),o=$("[class^=srp]"),r=!1;a.on("show.bs.modal",function(){var e=a.find(".modal-content .modal-body .img-responsive"),t=Math.floor(2*Math.random())+1;e.attr("src",e.data("src")+t+e.data("ext"))}),o.on("click",function(a){a.preventDefault();var o=$(this);if(o.hasClass("active")){var s=o.attr("class").split(" ")[0].substr(3);r=!0,n.attr("src",n.data("srp")+s+n.data("ext")),t.modal("show"),$.ajax({url:"/ajax/picture_found.php?ajax=true",data:{number:s},type:"POST",dataType:"JSON",success:function(e){if(e.success&&e.modal&&e.modalId){var a=$("#"+e.modalId);t.on("hidden.bs.modal",function(){a.length<=0&&(i.append($(e.modal)),a=$("#"+e.modalId)),a.modal("show"),a.on("shown.bs.modal",function(){t.off("hidden.bs.modal")})})}switch(e.success){case"foundAll":r=!0,$(".pagin .pagination .page-item [class^=srp]").addClass("active")}},error:function(){e("Nieznany błąd","danger")}})}});var s=new MutationObserver(function(e){e.forEach(function(e){if("class"===e.attributeName){var t=$(e.target);r?r=!1:(t.removeClass("active"),a.modal("show"))}})}),c=new MutationObserver(function(e){e.forEach(function(e){"src"===e.attributeName&&(r?r=!1:(r=!0,n.attr("src",""),t.modal("hide"),setTimeout(function(){a.modal("show")},600)))})});"Node"==typeof n[0]&&c.observe(n[0],{attributes:!0}),o.each(function(e,t){s.observe(t,{attributes:!0})})}}(),$(document).on("click",".preload",function(e){$(e);n(),setTimeout(function(){o()},5e3)}).on("keydown",function(e){116===e.which&&n()}),function(){var n=$("body.settings");if(n.length){var o=n.find(".form form");o.on("submit",function(n){n.preventDefault();var i=new FormData(o.get(0));$.ajax({url:o.attr("action")+"?ajax=true",type:"POST",data:i,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){t()},success:function(t){e(t.message,t.alert)},error:function(){e("Nieznany błąd","danger")},complete:function(){a()}})})}}(),function(){var n=$("body.register");if(n.length){var o=$("#forgotPassword"),i=o.find("form");n.find(".logRegForm form").on("submit",function(e){e.preventDefault(),r($(this))}),o.on("show.bs.modal",function(){var e=n.find("input[name='lemail']").val();e.length&&o.find("#femail").val(e)}).on("shown.bs.modal",function(){o.find("#femail").trigger("focus")}),i.on("submit",function(n){n.preventDefault();var i=$(this),r=new FormData(i.get(0));r.append("forgotPassword",!0),$.ajax({url:i.attr("action")+"?ajax=true",type:"POST",data:r,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){t()},success:function(t){t.success&&o.modal("hide"),e(t.message,t.alert)},error:function(){e("Nieznany błąd","danger")},complete:function(){a()}})});var r=function(n){var o=new FormData(n.get(0));$.ajax({url:n.attr("action")+"?ajax=true",type:"POST",data:o,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){t()},success:function(t){t.success&&(location.href="/"),t.alert&&e(t.message,t.alert)},error:function(){e("Nieznany błąd","danger")},complete:function(){a()}})}}}(),function(){var e=$("body.register, body.settings");if(e.length){var t=e.find("#address"),a=e.find("#addressFinder"),n=setTimeout(function(){}),o=new L.LatLng(50.0619474,19.9368564),i=L.map("addressMap").setView(o,15);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(i);var r=L.marker(o,{draggable:"true"}).addTo(i),s=function(e){i.removeLayer(r),r.setLatLng(e),r.addTo(i),i.panTo(e),t.val(e.lat+","+e.lng)};if(""!==t.val()){var c=t.val().split(",");s(new L.LatLng(c[0],c[1]))}r.on("dragend",function(e){s(e.target._latlng)}),a.on("keyup",function(e){var t=a.val();clearTimeout(n),n=setTimeout(function(){$.get(location.protocol+"//nominatim.openstreetmap.org/search?format=json&q="+t,function(e){if(void 0!==e[0]){var t=e[0].lat,a=e[0].lon;s(new L.LatLng(t,a))}})},1e3)})}}(),setInterval(function(){$.ajax({url:"/ajax/notifications.php?ajax=true",type:"POST",data:{action:"get"},dataType:"JSON",success:function(e){if(e.success){var t=e.data;for(var a in t){var n=$("<a>");n.addClass("dropdown-item waves-effect waves-light active"),null!=t[a].href?(n.attr("href",t[a].href),n.addClass("preload")):n.attr("href","#"),n.html(t[a].content),n.prependTo("nav.navbar .notifications .dropdown-menu");var o=$("nav.navbar #notifications span.num");o.html(parseInt(o.html())+1),o.addClass("new")}}}})},1e4),function(){var n=$("body.privileges");if(n.length){var o=n.find("form.setPrivileges"),i=o.find("#usersID"),r=o.find("#level"),s={placeholder:"Wybierz użytkownika",allowClear:!0},c={placeholder:"Wybierz uprawnienie",minimumResultsForSearch:-1,allowClear:!0};i.select2(s),r.select2(c),i.on("change",function(){var e=i.find("option:selected");priv=e.data("priv"),r.val(priv),r.select2("destroy"),r.select2(c)}),o.on("submit",function(n){n.preventDefault();var c=o.get(0),d=new FormData(c);d.append("savePrivileges",!0),$.ajax({url:o.attr("action")+"?ajax=true",type:"POST",data:d,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){t()},success:function(t){if(t.success){var a=i.find("option:selected"),n=r.val(),o=a.text(),c=o.lastIndexOf("("),d=o.substr(0,c)+"("+n+")";a.text(d),a.data("priv",n),a.attr("data-priv",n),i.select2("destroy"),i.select2(s)}e(t.message,t.alert)},error:function(){e("Nieznany błąd","danger")},complete:function(){a()}})})}}()}),$.fn.isInViewport=function(){var e=$(this),t=e.offset().top,a=t+e.outerHeight(),n=$(window).scrollTop()-55,o=n+$(window).height();return a>n&&t<o&&a<o&&t>n}};loadScript("external.min.js",index);