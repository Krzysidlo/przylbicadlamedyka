function loadScript(e,a){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=JS_URL+"/"+e,n.onreadystatechange=a,n.onload=a,t.appendChild(n)}var index=function(){function e(e,a,t){a=a||"danger",t=void 0!==t?t:3e3;var n=$("<div>").addClass("kjtoast hidden alert alert-"+a);if(n.html(e),n.appendTo($("body .toastContainer")),n.fadeIn(),t>0){var o=setTimeout(function(){n.fadeOut(function(){n.remove()})},t);n.on("mouseenter",function(){clearTimeout(o)}).on("mouseleave",function(){o=setTimeout(function(){n.fadeOut(function(){n.remove()})},3e3)}).on("click",function(){clearTimeout(o),n.fadeOut(function(){n.remove()})})}return n}function a(a){var n=a.data("date"),o=a.data("id"),i=a.find("input.homeTeam").val()||null,r=a.find("input.awayTeam").val()||null;setTimeout(function(){$.ajax({url:"/ajax/save_score.php?ajax=true",type:"POST",data:{eventDate:n,eventId:o,homeTeam:i,awayTeam:r},dataType:"JSON",beforeSend:function(){a.find(".score_load, .score_save, .score_err").hide(),a.find(".score_load").fadeIn()},success:function(n){if(n.success){if(a.find(".submitBtn").fadeOut(),!n.alert){var o=a.find(".prediction");o.addClass("bet"),o.find(".scoreHomeTeam").html(a.find("input.homeTeam").val()),o.find(".scoreAwayTeam").html(a.find("input.awayTeam").val())}a.find(".score_load").fadeOut(function(){a.find(".score_save").fadeIn(),setTimeout(function(){a.find(".score_save").fadeOut()},4e3)})}else a.find(".submitBtn").fadeIn(),a.find(".score_load").fadeOut(function(){a.find(".score_err").fadeIn(),setTimeout(function(){a.find(".score_err").fadeOut()},4e3)});n.alert&&(e(n.message,n.alert),n.start&&t(a))},error:function(){a.find(".submitBtn").fadeIn(),a.find(".score_load").fadeOut(function(){a.find(".score_err").fadeIn(),setTimeout(function(){a.find(".score_err").fadeOut()},4e3)})}})},1e3)}function t(e){e.find(".team input.homeTeam").val(""),e.find(".team input.awayTeam").val(""),e.find(".team h3.score").html(0),e.attr("data-status","DATE"),e.data("status","DATE"),e.find(".chooseJoker").fadeOut(),u.push(e.data("id"))}function n(){$("#loading").fadeIn()}function o(){$("#loading").fadeOut()}function i(){d.fadeOut();$("body").removeClass("no_scroll")}function r(){d.fadeIn(),$("body").addClass("no_scroll"),setTimeout(function(){i()},7e3)}function s(){navigator.serviceWorker.ready.then(function(e){e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){const a=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(a),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}("BKQjBUuGol8D5pFJDN9AHuRZL9vYQ94TnzuVR6-tYyfbwMXhrZ_ORzJaZCovdAB-546eTvzrP5ibzJ-JUuTr6es")}).then(function(e){$.ajax({url:"/ajax/push_subscription.php?ajax=true",type:"POST",data:{subscription:JSON.stringify(e)},dataType:"JSON",success:function(e){console.log(e)}})}).catch(function(e){console.error("Subscription for Push failed",e)})})}function c(){alert("W celu włączenia powiadomień PUSH proszę kliknąć na kłódkę obok adresu www i przy opcji 'powiadomienia' wybrać 'zezwól'")}var d=$("#preloader"),u=($(".register #video"),[]);$(window).on("load",function(){i()}),$(function(){(new WOW).init();var d=$("body");d.data("logged")&&"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope);var a;e.installing?a=e.installing:e.waiting?a=e.waiting:e.active&&(a=e.active),a&&a.addEventListener("statechange",function(e){e.target.state})},function(e){console.error("ServiceWorker registration failed: ",e)})}),Push.config({serviceWorker:"/sw.js"}),d.data("logged")&&(Push.Permission.has()||"denied"===Push.Permission.get()||Push.Permission.request(s())),$(document).trigger("scroll"),!function(){var e=!1;return function(a){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}()&&d.height()>$(window).height()&&d.addClass("desktop"),function(){var e,a=$("body"),t=$("nav.navbar"),n=t.find(".navbar-toggler"),o=t.find(".navbar-collapse"),i=t.find(".notifications");n.on("click",function(){o.hasClass("show")?a.removeClass("collapsed"):a.addClass("collapsed")}),i.find("#notifications").on("click",function(){e=setTimeout(function(){$.ajax({url:"/ajax/notifications.php?ajax=true",data:{action:"read"},type:"POST",dataType:"JSON",success:function(e){e.success&&i.find("#notifications .num").html("0").removeClass("new")}})},1500)}).on("blur",function(){clearTimeout(e)}),i.find(".dropdown-menu a.dropdown-item").on("click",function(e){var t=$(this).attr("href"),o=window.location.pathname,i=t.split("#");shouldPrevent="#"===t,shouldPrevent&&e.preventDefault(),shouldPrevent|=t.indexOf("#")>=0&&i[0]==o,shouldPrevent&&(e.stopPropagation(),a.hasClass("collapsed")&&n.trigger("click"))})}(),function(){var e="",a=setTimeout(function(){});$(document).on("keyup",function(t){if(void 0!==t.key){var n=t.key.toLowerCase();"capslock"!==n&&"shift"!==n&&(e+=n),clearTimeout(a),a=setTimeout(function(){"impreza"===e.toLowerCase()&&function(){var e=$("body"),a=e.find("#party");a.length<=0&&(a=$("<audio id='party' src='"+MSC_URL+"/final_countdown.mp3'></audio>"),e.append(a)),a.get(0).play(),$elements=e.find(".eventsBox"),$elements.length<=0&&($elements=e.find("table")),$elements.length<=0&&($elements=e.find(".form")),setTimeout(function(){var a=$(".wfi");a.length<=0&&(a=$("<h2 class='wfi'>Wait for it</h2>"),e.append(a)),a.fadeIn(),a.addClass("scaled"),setTimeout(function(){a.fadeOut()},4e3)},2e4),e.effect("shake",{times:200},16e4),setTimeout(function(){e.find("nav").effect("shake",{times:360},12e4);var a=setInterval(function(){$elements.toggle("scale")},500);setTimeout(function(){clearInterval(a)},12e4)},4e4)}(),e=""},1e3)}})}(),function(){var e=$(".ccm");$(document).on("contextmenu",function(a){a.preventDefault();var t=a.pageX,n=a.pageY-parseInt($("body").css("margin-top"));e.css({left:t+"px",top:n+"px"}).show()}).on("click",function(){e.hide()}),$(window).on("scroll",function(){e.hide()})}(),$(".dropdown #change + .dropdown-menu .dropdown-item").on("click",function(){$(this).closest("form").submit()}),function(){if($("section.loginRegister").length<=0){var a=$("#surpriseModal"),t=$("#cheatingModal"),n=a.find("img.img-responsive"),o=$("[class^=srp]"),i=!1;t.on("show.bs.modal",function(){var e=t.find(".modal-content .modal-body .img-responsive"),a=Math.floor(2*Math.random())+1;e.attr("src",e.data("src")+a+e.data("ext"))}),o.on("click",function(t){t.preventDefault();var o=$(this);if(o.hasClass("active")){var r=o.attr("class").split(" ")[0].substr(3);i=!0,n.attr("src",n.data("srp")+r+n.data("ext")),a.modal("show"),$.ajax({url:"/ajax/picture_found.php?ajax=true",data:{number:r},type:"POST",dataType:"JSON",success:function(e){if(e.success&&e.modal&&e.modalId){var t=$("#"+e.modalId);a.on("hidden.bs.modal",function(){t.length<=0&&(d.append($(e.modal)),t=$("#"+e.modalId)),t.modal("show"),t.on("shown.bs.modal",function(){a.off("hidden.bs.modal")})})}switch(e.success){case"foundAll":i=!0,$(".pagin .pagination .page-item [class^=srp]").addClass("active")}},error:function(){e("Ajax error","danger")}})}});var r=new MutationObserver(function(e){e.forEach(function(e){if("class"===e.attributeName){var a=$(e.target);i?i=!1:(a.removeClass("active"),t.modal("show"))}})}),s=new MutationObserver(function(e){e.forEach(function(e){"src"===e.attributeName&&(i?i=!1:(i=!0,n.attr("src",""),a.modal("hide"),setTimeout(function(){t.modal("show")},600)))})});"Node"==typeof n[0]&&s.observe(n[0],{attributes:!0}),o.each(function(e,a){r.observe(a,{attributes:!0})})}}(),$(document).on("click",".preload",function(e){$(e);r(),setTimeout(function(){i()},5e3)}).on("keydown",function(e){116===e.which&&r()}),function(){var n=$("body.index");if(n.length){var o,i,r=n.find(".parallax");r.length&&r.find(".downArrow img").on("click",function(){$("html, body").animate({scrollTop:n.scrollTop()+r.height()-52+"px"},400)});var s=n.find(".eventsBox .event");s.find(".inputs input").on("keypress",function(e){var a=$(this),t=a.get(0).selectionStart,n=a.get(0).selectionEnd;32===e.which&&e.preventDefault(),(isNaN(String.fromCharCode(e.which))||a.val().length>1&&a.val().substring(t,n).length<=0)&&e.preventDefault()}).on("keydown",function(e){var a=$(this),t=parseInt(a.val());if(!e.shiftKey&&!e.ctrlKey&&e.which>=37&&e.which<=40){switch(e.preventDefault(),38!==e.which&&40!==e.which||!isNaN(t)||(t=0),e.which){case 37:case 39:var n=a.closest(".event"),o="homeTeam";a.hasClass("homeTeam")?(o="awayTeam",37===e.which&&(n=n.prev().length>0?n.prev():n.parents(".row").prev().prev().find(".eventsBox .event:last-of-type"))):39===e.which&&(n=n.next().length>0?n.next():n.parents(".row").next().next().find(".eventsBox .event:first-of-type"));var i=n.find(".inputs input."+o);i.length&&i.trigger("focus");break;case 38:t++;break;case 40:t--}t>=0&&t<100&&a.val(t)}else 13===e.which&&(e.preventDefault(),a.trigger("blur"))}).on("keyup",function(e){32!==e.which&&a($(this).closest(".event"))}).on("blur",function(){a($(this).closest(".event"))}),s.find(".prediction .score").on("click",function(){var e=$(this);$("#"+e.data("id")).modal("show")});var c=!1;s.each(function(e,a){var t=$(a);t.hasClass("joker")&&"TIMED"!==t.data("status")&&(c=!0)}),s.find("a.chooseJoker").on("click",function(a){a.preventDefault();var n=$(this).parents(".event");if(c)n.hasClass("joker")||e($(this).data("warning"),"warning");else{var o=n.find("input[name='eventDay']").val(),i=n.data("date"),r=n.data("id"),d=$(".events .eventsBox .event.joker").data("id"),u=!1;n.hasClass("joker")&&(u=!0),s.removeClass("joker"),u||n.addClass("joker"),$.ajax({url:"/ajax/save_joker.php?ajax=true",type:"POST",data:{eventDay:o,eventDate:i,eventId:r,prevId:d,removeOnly:u},dataType:"JSON",success:function(a){a.alert&&(n.removeClass("joker"),e(a.message,a.alert),a.start&&t(n))},error:function(){e("Ajax error","danger"),n.removeClass("joker")},complete:function(){!function(a){$.ajax({url:"/ajax/get_joker.php?ajax=true",type:"POST",data:{},dataType:"JSON",success:function(e){e.success&&(a.removeClass("joker"),a.filter('[data-id="'+e.id+'"]').addClass("joker"))},error:function(){e("Ajax error","danger")}})}(s)}})}});var d=s.filter('[data-status="TIMED"]');if(d.length){var l=[];d.each(function(e,a){l.push($(a).data("id"))}),i=setInterval(function(){if(l.length<=0)return clearInterval(i),!1;$.ajax({url:"/ajax/check_event.php?ajax=true",type:"POST",data:{action:"shouldStart",events:l},dataType:"JSON",success:function(a){a.success&&$.each(a.statuses,function(e,a){"TIMED"!==a&&(t(s.filter('[data-id="'+e+'"]')),l.splice($.inArray(e,l),1))}),a.alert&&e(a.message,a.alert)}})},15e3)}var f=s.filter('[data-status="IN_PLAY"]');f.length&&f.each(function(e,a){u.push($(a).data("id"))}),o=setInterval(function(){if(u.length<=0)return clearInterval(o),!1;$.ajax({url:"/ajax/check_event.php?ajax=true",type:"POST",data:{action:"inPlay",events:u},dataType:"JSON",success:function(a){a.success&&$.each(a.events,function(e,a){!function(e,a){e.find(".team h3.score.homeTeam").html(a.homeTeam||0),e.find(".team h3.score.awayTeam").html(a.awayTeam||0),e.attr("data-status",a.status),e.data("status",a.status)}(s.filter('[data-id="'+e+'"]'),a),"FINISHED"===a.status&&u.splice($.inArray(e,u),1)}),a.alert&&e(a.message,a.alert)}})},15e3)}}(),$("body.change").length&&$("body.change .eventBox .event").on("click",function(e){$(this).hasClass("locked")&&e.preventDefault()}),function(){var a=$("body.settings");if(a.length){var t=a.find(".form form"),i=t.find("input[name='darkTheme']"),r=t.find("input[name='pushNotifications']"),d=t.find("input[name='parallax']"),u=t.find("input[name='parallaxUrl']"),l=t.find("input[name='avatar']"),f=t.find("label[for='avatar']"),p=t.find("input[name='gravatar']"),v=l.parent(),m=v.find("#profile"),h=a.find("#source");t.on("submit",function(a){a.preventDefault(),function(a){var t=new FormData(a.get(0));t.append("saveSettings",!0),$.ajax({url:a.attr("action")+"?ajax=true",type:"POST",data:t,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){n()},success:function(a){e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})}(t)}),i.on("change",function(){var e=$("link.theme");$(this).prop("checked")?(e.attr("href",e.data("dark")),$("nav.navbar").removeClass("navbar-light bg-light").addClass("navbar-dark bg-dark")):(e.attr("href",e.data("light")),$("nav.navbar").removeClass("navbar-dark bg-dark").addClass("navbar-light bg-light"))}),r.on("change",function(){var e=$(this);e.prop("checked")&&(Push.Permission.has()||"denied"===Push.Permission.get()?Push.Permission.has()||(e.prop("checked",!1),c()):Push.Permission.request(s(),c()))}),d.on("change",function(){$(this).prop("checked")?u.parent().fadeIn():u.parent().fadeOut()});var g=u.parent().find("i.fa");g.hasClass("active")&&g.removeClass("active"),u.on("blur",function(){g.removeClass("active")}),p.on("change",function(){var e=l.parents(".avatarParent");$(this).prop("checked")?e.fadeOut():e.fadeIn()}),f.on("click",function(e){e.preventDefault(),h.modal("show")});var w=!1;h.on("click",".option.capture",function(e){e.preventDefault(),w=!0,h.modal("hide")}).on("click",".option.upload",function(e){e.preventDefault(),h.modal("hide"),l.trigger("click")}).on("hidden.bs.modal",function(){w&&(T.modal("show"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(e){j=e,S.srcObject=e,S.play()}).catch(function(e){console.log("error",e)}),w=!1)});var y="";l.on("change",function(){var e=this,a=new FileReader;e.files&&e.files[0]?(y=e.files,a.onload=function(e){m.attr("src",e.target.result),v.find(".removePic").removeClass("hidden"),v.find("input[name='save_avatar']").val("true")},a.readAsDataURL(y[0])):l.prop("files",y)});var b=!1;v.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){v.addClass("drag")}).on("dragleave dragend drop",function(){v.removeClass("drag")}).on("drop",function(a){(b=a.originalEvent.dataTransfer.files).length>=2?(k(v.find(".removePic")),e(l.data("tmf"),"warning")):(l.prop("files",b),l.trigger("change"))}),v.find(".removePic").on("click",function(){k($(this))});var k=function(e){e.addClass("hidden"),l.val(""),v.find("input[name='save_avatar']").val(""),m.attr("src",l.data("default")),y="",l.prop("files",y)};a.find("#recountPoints").on("click",function(a){a.preventDefault(),$.ajax({url:"/ajax/recalculate_points.php?ajax=true",type:"POST",dataType:"JSON",beforeSend:function(){n()},success:function(a){a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})});var x,j,T=a.find("#camera"),O=T.find("img.preview"),S=T.find("video.camera_stream")[0],D=$(S).parents(".box"),P=O.parents(".box"),C=T.find(".capture"),z=T.find(".again"),A=T.find(".save");A.hide(),z.hide(),C.on("click",function(e){e.preventDefault();var a=$(this),t=T.find("canvas.snapshot")[0],n=S.videoWidth,o=S.videoHeight,i=t.getContext("2d");t.width=n,t.height=o,i.drawImage(S,0,0,n,o),x=t.toDataURL("image/jpg"),O.attr("src",x),D.hide(),P.show(),a.hide(),z.show(),A.show()}),z.on("click",function(e){e.preventDefault(),D.show(),P.hide(),C.show(),z.hide(),A.hide()}),T.on("hidden.bs.modal",function(){var e=j.getTracks()[0];O.attr("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),e.stop(),z.trigger("click")}),A.on("click",function(a){a.preventDefault(),$.ajax({url:"/ajax/save_picture.php?ajax=true",type:"POST",data:{file:x},dataType:"JSON",beforeSend:function(){n()},success:function(a){a.success?(m.attr("src",a.picture+"?date="+Date.now()),v.find(".removePic").removeClass("hidden"),v.find("input[name='save_avatar']").val("capture")):a.alert&&e(a.message,a.alert),T.modal("hide")},error:function(){e("Wystąpił błąd podczas przetwarzania zdjęcia, przepraszamy.","danger"),T.modal("hide")},complete:function(){o()}})});var _=a.find("#changePasswordModal"),I=a.find("#changePassword"),N=_.find("form"),J=_.find("button[type='submit']");I.on("click",function(e){e.preventDefault(),_.modal("show")}),J.on("click",function(a){a.preventDefault();var t=N.get(0),i=new FormData(t);i.append("changePassword",!0),$.ajax({url:N.attr("action")+"?ajax=true",type:"POST",data:i,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){n()},success:function(a){if(a.success)_.modal("hide");else{var t=a.field.split(",");$(t).each(function(e,a){N.find('input[name="'+a+'"]').removeClass("valid").addClass("invalid").trigger("focus")})}e(a.message,a.alert)},error:function(){e("Wystąpił błąd podczas próby zmiany hasła. Proszę odświeżyć stronę i spróbować ponownie","danger")},complete:function(){o()}})}),_.on("hidden.bs.modal",function(e){N.find("input").val("").trigger("blur")});var B=a.find("#groupsModal"),W=B.find("input#groupName"),M=B.find("input#groupCode"),E=B.find("button#createJoin");M.on("keyup",function(e){if(13===e.which)return e.preventDefault(),E.trigger("click"),!1}),W.on("keyup",function(e){if(13===e.which)return e.preventDefault(),E.trigger("click"),!1;""===W.val()?E.removeClass("create"):E.addClass("create")}),E.on("click",function(a){a.preventDefault();var t=W.val(),n=M.val();if(""===t){if(""===n)return e("Proszę podać hasło do grupy, aby móc do niej dołączyć","warning"),!1;$.ajax({url:"/ajax/groups.php?ajax=true",type:"POST",data:{action:"join",code:n},dataType:"JSON",beforeSend:function(){E.addClass("loading")},success:function(a){if(a.success){$(a.newRow).insertBefore(B.find("table tr.form")).fadeIn(),W.val("").trigger("blur"),M.val("").trigger("blur")}a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){E.removeClass("loading")}})}else{if(""===n)return e("Proszę podać hasło dla nowej grupy o nazwie '"+t+"'","warning"),!1;$.ajax({url:"/ajax/groups.php?ajax=true",type:"POST",data:{action:"new",name:t,code:n},dataType:"JSON",success:function(a){if(a.success&&a.success){$(a.newRow).insertBefore(B.find("table tr.form")).fadeIn(),W.val("").trigger("blur"),M.val("").trigger("blur")}a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")}})}}),B.find("table").on("click","button.leave",function(a){a.preventDefault();var t=$(this).parents("tr"),n=t.data("id");$.ajax({url:"/ajax/groups.php?ajax=true",type:"POST",data:{action:"leave",id:n},dataType:"JSON",success:function(a){a.success&&t.fadeOut(function(){t.remove()}),a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")}})}),B.find("table").on("click","button.delete",function(a){if(a.preventDefault(),!confirm("UWAGA! Usunięcie grupy jest nieodwracalne. Spoowoduje to, że wszyscy użytkownicy, którzy są do niej przypisani zostaną z niej usunięci. Czy na pewno chcesz to zrobić?"))return!1;var t=$(this).parents("tr"),n=t.data("id");$.ajax({url:"/ajax/groups.php?ajax=true",type:"POST",data:{action:"delete",id:n},dataType:"JSON",success:function(a){a.success&&t.fadeOut(function(){t.remove()}),a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")}})})}}(),function(){var a=$("body.register");if(a.length){console.log("??");var t=$("#easyLogin"),i=$("#forgotPassword"),r=i.find("form"),s=a.find(".logRegForm form");console.log(s),s.on("submit",function(e){e.preventDefault(),c($(this))}),t.length&&(t.on("shown.bs.modal",function(){t.find("#mpassword").focus()}),setTimeout(function(){t.modal("show")},300),t.find("form").on("submit",function(e){e.preventDefault(),c($(this))})),i.on("show.bs.modal",function(){var e=a.find("input[name='lemail']").val();e.length&&i.find("#femail").val(e)}).on("shown.bs.modal",function(){i.find("#femail").trigger("focus")}),r.on("submit",function(a){a.preventDefault();var t=$(this),r=new FormData(t.get(0));r.append("forgotPassword",!0),$.ajax({url:t.attr("action")+"?ajax=true",type:"POST",data:r,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){n()},success:function(a){a.success&&i.modal("hide"),e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})});var c=function(a){var t=new FormData(a.get(0));$.ajax({url:a.attr("action")+"?ajax=true",type:"POST",data:t,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){n()},success:function(a){a.success&&(location.href="/"),a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})}}}(),function(){var e=$("body.ranking");e.length&&(e.find(".rank table").DataTable({language:{url:"/media/js/pl.json"}}),e.find("#changeGroup").on("change",function(e){e.preventDefault();var a=$(this).val();r(),location.href="/ranking/"+a}))}(),function(){var e=$("body.summary");e.length&&(e.find("#changeGroup").on("change",function(e){e.preventDefault();var a=$(this).val();r(),location.href="/summary/"+a}),e.find(".eventsBox .event .prediction.showAll").on("click",function(e){e.preventDefault();$(this).parents(".event").toggleClass("all")}))}(),setInterval(function(){$.ajax({url:"/ajax/notifications.php?ajax=true",type:"POST",data:{action:"get"},dataType:"JSON",success:function(e){if(e.success){var a=e.data;for(var t in a){var n=$("<a>");n.addClass("dropdown-item waves-effect waves-light active"),null!=a[t].href?(n.attr("href",a[t].href),n.addClass("preload")):n.attr("href","#"),n.html(a[t].content),n.prependTo("nav.navbar .notifications .dropdown-menu");var o=$("nav.navbar #notifications span.num");o.html(parseInt(o.html())+1),o.addClass("new")}}}})},1e4),function(){var e=$("body.events");if(e.length){e.find("form.event").each(function(e,a){var t=$(a);t.on("submit",function(e){e.preventDefault();var a=t.data("id"),n=t.find("input.homeTeam").val()||null,o=t.find("input.awayTeam").val()||null;$.ajax({url:t.attr("action")+"?ajax=true",type:"POST",data:{eventId:a,homeTeam:n,awayTeam:o},dataType:"JSON",beforeSend:function(){t.find(".score_load, .score_save, .score_err").hide(),t.find(".score_load").fadeIn()},success:function(e){e.success?t.find(".score_load").fadeOut(function(){t.find(".score_save").fadeIn(),setTimeout(function(){t.find(".score_save").fadeOut()},4e3)}):t.find(".score_load").fadeOut(function(){t.find(".score_err").fadeIn(),setTimeout(function(){t.find(".score_err").fadeOut()},4e3)})},error:function(){t.find(".score_load").fadeOut(function(){t.find(".score_err").fadeIn(),setTimeout(function(){t.find(".score_err").fadeOut()},4e3)})}})})})}}(),function(){var a=$("body.privileges");if(a.length){var t=a.find("form.setPrivileges"),i=t.find("#usersID"),r=t.find("#level"),s={placeholder:"Wybierz użytkownika",allowClear:!0},c={placeholder:"Wybierz uprawnienie",minimumResultsForSearch:-1,allowClear:!0};i.select2(s),r.select2(c),i.on("change",function(){var e=i.find("option:selected");priv=e.data("priv"),r.val(priv),r.select2("destroy"),r.select2(c)}),t.on("submit",function(a){a.preventDefault();var c=t.get(0),d=new FormData(c);d.append("savePrivileges",!0),$.ajax({url:t.attr("action")+"?ajax=true",type:"POST",data:d,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){n()},success:function(a){if(a.success){var t=i.find("option:selected"),n=r.val(),o=t.text(),c=o.lastIndexOf("("),d=o.substr(0,c)+"("+n+")";t.text(d),t.data("priv",n),t.attr("data-priv",n),i.select2("destroy"),i.select2(s)}e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})})}}(),function(){var a=$("body.competitions");if(a.length){var t=a.find("[data-name]"),i=a.find(".event .title input"),r=a.find(".event form.changePicture"),s=r.find("input[type='file']"),c=a.find("#newCompetition"),d=a.find("#newCompetitionForm"),u="";a.find("button.updateCompetitionsList").on("click",function(a){a.preventDefault(),$.ajax({url:"/admin/ajax/competition.php?ajax=true",type:"POST",data:{action:"get"},dataType:"JSON",beforeSend:function(){n()},success:function(a){a.success&&location.reload(),a.alert&&e(a.message,a.alert)},error:function(){e("Błąd ajaxa","danger")},complete:function(){o()}})}),t.on("click",function(e){e.preventDefault();var a=$(this);switch(a.data("name")){case"name":var t=a.parent().find(".title input");t.prop("readonly")&&(u=t.val(),t.prop("readonly",!1).focus().val("").val(u));break;case"img":a.parents(".event").find("input[type='file']").trigger("click");break;case"new":c.modal("show")}}),i.on("keyup",function(a){var t=$(this);switch(a.which){case 13:a.preventDefault();var n=t.val(),o=t.parents(".event").data("id");$.ajax({url:"/admin/ajax/competition.php?ajax=true",type:"POST",data:{action:"name",name:n,id:o},dataType:"JSON",success:function(a){a.success&&(u=n,t.trigger("blur")),a.alert&&e(a.message,a.alert)},error:function(){e("Błąd ajaxa","danger")}});break;case 27:a.preventDefault(),t.val(u),t.prop("readonly",!0)}}).on("blur",function(){var e=$(this);e.prop("readonly")||(e.val(u),e.prop("readonly",!0))}),s.on("change",function(){$(this).parents(".event").find("form").trigger("submit")}),r.on("submit",function(a){a.preventDefault();var t=$(this);id=t.parents(".event").data("id");var n=new FormData(t.get(0));n.append("action","img"),n.append("id",id),$.ajax({url:"/admin/ajax/competition.php?ajax=true",type:"POST",data:n,dataType:"JSON",processData:!1,contentType:!1,success:function(a){a.success?location.reload():a.alert&&e(a.message,a.alert)},error:function(){e("Błąd ajaxa","danger")}})}),c.on("hidden.bs.modal",function(){d.get(0).reset()}),d.on("submit",function(a){a.preventDefault();var t=new FormData(d.get(0));t.append("action","new"),$.ajax({url:d.attr("action")+"?ajax=true",type:"POST",data:t,dataType:"JSON",processData:!1,contentType:!1,beforeSend:function(){n()},success:function(a){a.success?location.reload():a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})})}}(),function(){var a=$("body.recalculate");if(a.length){a.find("#recalculate").on("click",function(t){if(t.preventDefault(),"tak"!==prompt("UWAGA! Przeliczenie punktów spowoduje utratę informacji o poprzednich punktach pozycjach i.t.p. Czy na pewno chcesz to zrobić? (tak)"))return!1;var i=a.find(".container.events").data("comp");$.ajax({url:"/admin/ajax/recalculate.php?ajax=true",type:"POST",data:{compID:i},dataType:"JSON",beforeSend:function(){n()},success:function(a){a.success?location.reload():a.alert&&e(a.message,a.alert)},error:function(){e("Ajax error","danger")},complete:function(){o()}})})}}()}),$.fn.isInViewport=function(){var e=$(this),a=e.offset().top,t=a+e.outerHeight(),n=$(window).scrollTop()-55,o=n+$(window).height();return t>n&&a<o&&t<o&&a>n}};loadScript("external.min.js",index);